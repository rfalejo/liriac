# Ticket BL-008: TUI Editor — Basic Text Editing and Manual Save

## Description
Introduce a minimal editor screen that lets the user open a chapter, edit its text, and manually save changes. The editor is a Textual screen that:
- Loads a chapter via the existing filesystem repository (`FilesystemLibraryRepository`) using the `ChapterRepository` port.
- Renders the chapter content in a scrollable, editable text area.
- Tracks a “dirty” state when content changes and exposes a save action that writes the updated text back to disk atomically via `repo.write_chapter(...)`.
- Integrates with the app flow from the Home screen: when the user selects a chapter (`ChapterChosen`), the app opens the editor with that chapter loaded.

Keep business logic out of the view. No autosave, no suggestions, and no network calls in this ticket.

## Acceptance Criteria
- Source layout:
  - `src/liriac/tui/screens/editor/view.py`:
    - Implements `class EditorScreen(Screen)` with a constructor:
      - `EditorScreen(library_path: Path, repo: ChapterRepository, ref: ChapterRef)`
    - On mount:
      - Calls `repo.read_chapter(library_path, ref)` to load the chapter.
      - Renders an editable, scrollable text widget with the chapter’s text.
      - Displays a small status/footer line with file path info and a modified indicator when dirty.
    - Actions/Bindings:
      - Editing updates an internal dirty flag.
      - Pressing `Ctrl+S` (and/or `s`) triggers save:
        - Calls `repo.write_chapter(library_path, Chapter(..., text=<current text>))`.
        - Clears the dirty flag and updates the status/footer.
      - Pressing `escape` returns to the previous screen without saving (no confirmation required in this ticket).
    - Types: fully annotated; no implicit `Any`.
  - `src/liriac/tui/__init__.py`:
    - Exports `EditorScreen` via `__all__` alongside existing exports.
- App integration:
  - `src/liriac/app.py`:
    - Handles `ChapterChosen` by pushing `EditorScreen(library_path, repo, ref)`.
    - Keeps `q`/`Ctrl+C` to quit the app as before.
- Repositories:
  - Use the existing `FilesystemLibraryRepository` (implements `ChapterRepository`) to perform reads and writes.
  - Ensure no extra writes happen apart from explicit manual save.
- Behavior:
  - Editor loads chapter content verbatim (UTF-8).
  - Dirty state reflects unsaved edits; after successful save, dirty resets.
  - Save uses the repository’s atomic write behavior; line endings and trailing newline are handled by the repo.
- Packaging and dependencies:
  - No new dependencies; use existing `textual` version already in the project.
- Typing and style:
  - Code passes `mypy --strict`.
  - `ruff` and `black` pass with no changes after formatting.
- Developer workflow:
  - `make run ARGS="--path <library>"`:
    - Home screen appears.
    - Selecting a chapter opens the editor.
    - Editing and `Ctrl+S` saves changes to the chapter file.

## Testing Strategy
- TUI tests (Textual Pilot): add `tests/tui/test_editor.py`.
  - Import tests:
    - `from liriac.tui.screens.editor.view import EditorScreen` succeeds.
  - Load and render:
    - Create a temp library: `<tmp>/<book>/book.toml` with a valid chapter entry and `<tmp>/<book>/chapters/01.md` with sample text.
    - Instantiate `EditorScreen(library_path, FilesystemLibraryRepository(), ref)` inside `LiriacApp.run_test()`.
    - Assert the initial text displayed matches the chapter file content.
  - Dirty indicator:
    - Type additional text; assert the footer or an internal flag reflects modified state.
  - Manual save:
    - Press `Ctrl+S` (or simulate the save action).
    - Verify the chapter file on disk updates to include the new content and ends with a trailing newline (as enforced by the repo).
    - Assert the dirty indicator resets after save.
  - Navigation:
    - Press `escape` to return to the previous screen; ensure the app does not crash and the previous screen becomes active.
- App integration test:
  - Within `LiriacApp.run_test()`, post a `ChapterChosen` message for a valid chapter and assert the app pushes `EditorScreen`.
- Quality gates:
  - `make fmt`, `make lint`, `make typecheck`, and `make test` all pass.
