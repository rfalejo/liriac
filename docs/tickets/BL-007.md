# Ticket BL-007: TUI Home Screen — List and Select Books/Chapters

## Description
Add the first real TUI screen to browse the user’s library and pick a chapter. Build a Home screen in Textual that:
- Lists available books discovered under the selected `library_path`.
- Loads the selected book’s metadata and shows its chapters.
- Emits a typed selection event when the user confirms a chapter (editor will arrive in a later ticket).
- Uses the existing filesystem repository (`FilesystemLibraryRepository`) through the domain `LibraryRepository` and `ChapterRepository` protocols.
- Keeps the UI responsive and simple; no network calls or disk writes.

Follow the technical spec’s structure for TUI components. Maintain strict typing and avoid implicit `Any`. Keep business logic out of views; limit IO to repository reads invoked by the screen/controller.

## Acceptance Criteria
- Source layout:
  - `src/liriac/tui/__init__.py`:
    - Exports `HomeScreen` and the selection message class (see below) via `__all__`.
  - `src/liriac/tui/screens/home/view.py`:
    - Implements `class HomeScreen(Screen)`.
    - Constructor accepts `library_path: Path` and a `repo: LibraryRepository` (the same instance may implement `ChapterRepository` but only listing/loading is needed here).
    - On mount:
      - Calls `repo.list_books(library_path)`; populates a books list widget.
      - When a book is selected, calls `repo.load_book(library_path, book_id)` and populates a chapters list widget with `ChapterRef`s.
    - Layout:
      - Two-pane layout: left books list, right chapters list; a small status/footer line with basic instructions.
      - Keyboard:
        - Up/Down: navigate focused list.
        - Tab/Shift+Tab: switch focus between lists.
        - Enter on a chapter: emits a `ChapterChosen` message (see below).
        - `q` to exit remains handled by `LiriacApp` as in BL-002.
    - Messages:
      - Define a Textual `Message` subclass `ChapterChosen` carrying `book_id: BookId` and `ref: ChapterRef`.
      - Post this message when user presses Enter on a chapter item.
    - Empty/edge states:
      - If no books are found: render a placeholder “No books found in library” in the chapters pane.
      - If `load_book` fails (e.g., invalid TOML), show a concise inline error in the chapters pane; do not crash.
  - Optional controller split:
    - If desired, minimal controller helpers can live in the same module; a separate `controller.py` is not required for this ticket.
- App integration:
  - `src/liriac/app.py`:
    - At startup, mount/push `HomeScreen(library_path, repo)` instead of rendering the static placeholder.
    - Handle `ChapterChosen` by storing the last selection on the app (e.g., `self.last_selection = (book_id, ref)`) or logging it; do not open an editor yet.
- Repositories:
  - Use the concrete `FilesystemLibraryRepository` (already implemented) to satisfy the `LibraryRepository` interface.
  - No writes are performed in this ticket.
- Packaging and dependencies:
  - No new dependencies required; reuse `textual` already present.
- Typing and style:
  - Code passes `mypy --strict`.
  - `ruff` and `black` pass without changes after formatting.
- Developer workflow:
  - `make run ARGS="--path ."` starts the app and shows the Home screen.
  - Keyboard controls behave as specified; exit remains `q` or `Ctrl+C`.

## Testing Strategy
- TUI tests (Textual Pilot):
  - File: `tests/tui/test_home.py`.
  - Fixtures:
    - Use `tmp_path` to create a temporary library structure:
      ```
      <tmp>/book1/
        book.toml
        chapters/
          01.md
          02.md
      <tmp>/book2/
        book.toml
      ```
      With minimal valid `book.toml` (title, created_at, chapters list).
  - Tests:
    - Import test:
      - `from liriac.tui.screens.home.view import HomeScreen` succeeds.
    - Empty library:
      - Start `LiriacApp(library_path=empty_tmp)` with `HomeScreen`; assert “No books found” is rendered.
    - Listing and load:
      - Start with the populated temp library; assert books list shows `book1` and `book2`.
      - Focus books list, ensure selecting `book1` populates chapters list with `01.md`, `02.md` (stems or labels as implemented).
    - Keyboard navigation:
      - Use Pilot to send Up/Down and Tab to switch focus; ensure focus moves between lists.
    - Selection event:
      - Navigate to a chapter and press Enter; assert a `ChapterChosen` message is posted and that the app records `last_selection` with correct `BookId` and `ChapterRef`.
    - Error handling:
      - Create a book dir without `book.toml`; ensure it is not listed.
      - Create an invalid `book.toml` and ensure selecting that book shows an inline error instead of crashing.
- Non-goals:
  - Do not open an editor or write any files.
  - No network calls.
- Quality gates:
  - `make fmt`, `make lint`, `make typecheck`, and `make test` all pass.
