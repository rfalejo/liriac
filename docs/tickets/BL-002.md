# Ticket BL-002: Configure Linters, Formatters, and Strict Typing

## Description
Set up and enforce consistent linting, formatting, and strict typing across the monorepo. Frontend should use ESLint + Prettier with strict TypeScript; backend should use ruff + black + mypy (strict). Provide Makefile targets and package scripts so developers can run checks locally and CI can gate on green results. This work aligns with docs/01-technical-spec-en.md and docs/03-conventions.md.

## Goals
- One-command developer experience for lint, format, and type checks.
- Strict TypeScript and mypy across all code.
- Consistent editor/CI behavior (no drift between local and CI).

## Scope
- Frontend (`frontend/`): ESLint, Prettier, TypeScript strict config; Vitest ESLint plugin; React hooks rules.
- Backend (`backend/`): ruff, black, mypy strict; pytest and Channels typing stubs already configured.
- Makefile integration and CI-ready scripts.

## Acceptance Criteria
- Frontend:
  - ESLint config exists and lints TS/TSX with React 18/19, Vitest, and import rules; no lint errors on scaffold.
  - Prettier config exists; `pnpm prettier:check` reports clean; `pnpm prettier:write` formats code.
  - TypeScript strict mode enforced; `pnpm typecheck` exits 0 (noEmit).
  - `pnpm lint` and `pnpm test` pass on the existing code.
- Backend:
  - `uv run ruff check` passes with the configured selection; `ruff --fix` formats simple issues.
  - `uv run black --check .` passes; `uv run black .` formats when needed.
  - `uv run mypy --strict` passes on the project.
  - Pytest continues to pass: `uv run pytest`.
- Makefile:
  - `make fmt` runs Prettier + black; `make lint` runs ESLint + ruff.
  - `make typecheck` runs `tsc --noEmit` + `mypy --strict`.
  - `make check` runs lint, typecheck, and tests for both frontend and backend.
- CI gating (documented):
  - Documented steps to run in CI: lint, typecheck, test; pipeline fails on any violation.
- Documentation:
  - Short README note or comments in config files describing how to run these tools locally and the philosophy (no cosmetic diffs in PRs; run formatters before commit).

## Tasks
1. Frontend: add `.eslintrc` (or `eslint.config.js`) with TypeScript, React, React Hooks, and Vitest settings.
2. Frontend: add Prettier config (`.prettierrc` or `prettier.config.cjs`) and `.prettierignore`.
3. Frontend: add scripts: `prettier:check`, `prettier:write`, `lint:fix`; ensure `lint` and `typecheck` remain.
4. Backend: verify `pyproject.toml` contains ruff/black/mypy config (update only if needed to satisfy conventions).
5. Backend: ensure dev dependencies (ruff, black, mypy, pytest, stubs) are present via `uv pip install -e .[dev]` (documented).
6. Makefile: wire `fmt`, `lint`, `typecheck`, `check` to call both frontend and backend commands.
7. Run tools and fix any violations introduced by config tightening (no functional changes).
8. Add a brief docs snippet (README or comments) describing the commands and expected pre-commit workflow.

## Commands (local)
- Frontend:
  - Lint: `cd frontend && pnpm lint`
  - Lint (fix): `cd frontend && pnpm lint --fix` or `pnpm lint:fix`
  - Prettier check: `cd frontend && pnpm prettier:check`
  - Prettier write: `cd frontend && pnpm prettier:write`
  - Typecheck: `cd frontend && pnpm typecheck`
  - Tests: `cd frontend && pnpm test`
- Backend:
  - Ruff: `cd backend && uv run ruff check .`
  - Ruff (fix): `cd backend && uv run ruff check . --fix`
  - Black check: `cd backend && uv run black --check .`
  - Black write: `cd backend && uv run black .`
  - Mypy: `cd backend && uv run mypy --strict`
  - Tests: `cd backend && uv run pytest -q`

## Testing Strategy
- Run all acceptance commands and ensure zero errors:
  - `make lint`, `make fmt`, `make typecheck`, `make check`.
- Intentionally introduce a formatting issue locally to confirm:
  - Linters fail before fix; formatter resolves it; subsequent checks pass.
- Verify Vitest integration with ESLint (no false positives on test globals).
- Verify mypy strict does not flag untyped defs in existing code.

## Non-Goals
- Introducing new runtime dependencies beyond linters/formatters/type checkers.
- Changing application logic or tests beyond minimal fixes to satisfy linters/types.

## Notes & References
- Conventions: see docs/03-conventions.md (strict typing, tools, CI gating).
- Tech spec alignment: docs/01-technical-spec-en.md (toolchain and quality gates).
- Existing configs:
  - Frontend `package.json` already has scripts for lint, test, typecheck; extend for Prettier.
  - Backend `pyproject.toml` already includes ruff/black/mypy settings; prefer minimal adjustments.
- Optional: add `.editorconfig` for consistent indentation and newline settings (if not already present).
